<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>旅友WiFi PoC</title>
</head>
<body>
  <button onclick="sendLocation()">位置情報を送信</button>

<script>
function sendLocation() {
  navigator.geolocation.getCurrentPosition(function (position) {
    const latitude = position.coords.latitude;
    const longitude = position.coords.longitude;

    fetch("https://tabitomo-server.onrender.com/location", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        latitude,
        longitude,
        timestamp: new Date().toISOString()
      })
    }).then(() => alert("位置情報送信完了！"));
  });
}
</script>

<h1>旅友WiFi PoC テストページ</h1>
<p>このページは位置情報を取得し、Googleスプレッドシートに送信します。</p>
<button onclick="getLocation()">位置情報を送信する</button>
<div id="output"></div>

<script>
function getLocation() {
if (navigator.geolocation) {
navigator.geolocation.getCurrentPosition(sendPosition, showError);
} else {
document.getElementById("output").innerHTML = "このブラウザでは位置情報が取得できません。";
}
}

function sendPosition(position) {
const lat = position.coords.latitude;
const lng = position.coords.longitude;
document.getElementById("output").innerHTML = `緯度: ${lat}<br>経度: ${lng}`;

fetch("https://script.google.com/macros/s/AKfycbzkh-gililjD-gY2yUpglaNZbE_Iswjujr3gP3eDpRru6xl3St0ZqRnpKTPWp_2rVENsw/exec", {
method: "POST",
headers: {
"Content-Type": "application/json"
},
body: JSON.stringify({
latitude: lat,
longitude: lng
})
});
}

function showError() {
document.getElementById("output").innerHTML = "位置情報の取得に失敗しました。";
}
</script>
</body>
</html>
